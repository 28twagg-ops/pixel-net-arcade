<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PIXEL-NET V4</title>
    <style>
        /* --- THE RETRO AESTHETIC --- */
        body {
            background-color: #050505;
            color: #0f0;
            font-family: 'Courier New', monospace;
            margin: 0; padding: 0; overflow-x: hidden;
        }
        /* Scanline effect */
        body::after {
            content: " "; display: block; position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2; background-size: 100% 2px, 3px 100%; pointer-events: none;
        }

        /* --- LAYOUT --- */
        .header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 30px; border-bottom: 2px solid #0f0;
            box-shadow: 0 0 10px #0f0; background: #000;
        }
        .logo { font-size: 1.8em; font-weight: bold; text-shadow: 2px 2px #ff00ff; letter-spacing: 2px; }

        .container {
            max-width: 1200px; margin: 0 auto; padding: 20px;
            display: grid; grid-template-columns: 3fr 1.2fr; gap: 30px;
        }

        /* --- HERO SECTION (Cinematic Upgrade) --- */
        .hero-section {
            border: 2px solid #ff00ff; padding: 40px 20px;
            text-align: center; margin-bottom: 30px; 
            box-shadow: 0 0 15px #ff00ff;
            background-color: #000;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            min-height: 200px; /* Lengthened */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* Dark overlay so text pops over the image */
        .hero-overlay {
            position: absolute; inset: 0;
            background: rgba(0, 0, 0, 0.7); /* Darken the background image */
            z-index: 1;
        }
        
        .hero-content { position: relative; z-index: 2; } /* Keeps text on top */

        /* --- SEARCH --- */
        .library-controls {
            display: flex; flex-direction: column; gap: 10px;
            margin-bottom: 20px; border-bottom: 1px dashed #333; padding-bottom: 15px;
        }
        .search-wrapper { width: 100%; }
        
        #gameSearch {
            background: #000; border: 1px solid #0f0; color: #0f0;
            padding: 10px; font-family: 'Courier New', monospace; 
            width: 100%; box-sizing: border-box; font-size: 1em; outline: none;
        }
        #gameSearch:focus { box-shadow: 0 0 10px #0f0; }

        /* --- GAME GRID --- */
        .game-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 25px; }

        .cabinet {
            border: 1px solid #333; padding: 10px; text-align: center;
            transition: 0.3s; cursor: pointer; background: #0a0a0a; position: relative;
            box-shadow: 0 0 5px #000;
        }

        .cabinet:hover {
            border-color: #0f0; transform: translateY(-5px); 
            box-shadow: 0 0 25px rgba(0, 255, 0, 0.4); z-index: 10;
        }

        /* --- THUMBNAIL STYLING (75% Saturation) --- */
        .cabinet-screen {
            width: 100%; height: 200px; background-color: #000; margin-bottom: 12px;
            display: flex; align-items: center; justify-content: center;
            border: 1px solid #333; overflow: hidden;
        }
        
        .cabinet-thumb { 
            width: 100%; height: 100%; object-fit: contain;
            /* 75% Color by default */
            filter: saturate(75%) brightness(0.9); 
            transition: 0.4s ease;
        }

        .cabinet:hover .cabinet-thumb { 
            /* 100% Color + Glow on hover */
            filter: saturate(100%) brightness(1.2) drop-shadow(0 0 5px #fff); 
        }

        .game-title { font-weight: bold; font-size: 1.2em; color: #fff; margin-bottom: 5px; text-transform: uppercase; }
        .game-desc { font-size: 0.8em; color: #888; height: 2.4em; overflow: hidden; }

        /* --- SIDEBAR --- */
        .stats-panel { 
            border: 1px solid #0ff; padding: 15px; height: fit-content; 
            box-shadow: 0 0 10px #0ff; background: rgba(0, 255, 255, 0.05);
        }
        .section-title { 
            color: #0ff; border-bottom: 2px solid #0ff; padding-bottom: 5px; 
            margin-bottom: 15px; font-size: 1.1em; letter-spacing: 1px;
        }
        .legend-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9em; border-bottom: 1px dashed #222; padding-bottom: 4px; }
        .rank { width: 20px; color: gold; font-weight: bold; }
        .legend-info { flex-grow: 1; text-align: left; }

        /* --- LOGIN POPUP --- */
        .login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 20; display: flex; justify-content: center; align-items: center; flex-direction: column;
        }
        .login-box { text-align: center; border: 2px solid #0f0; padding: 40px; box-shadow: 0 0 30px #0f0; background: #000; }
        input { background: #111; border: 2px solid #0f0; color: #0f0; font-family: 'Courier New'; font-size: 2em; text-align: center; width: 150px; text-transform: uppercase; margin: 20px 0; outline: none; }

        /* --- GAME OVERLAY --- */
        #gameOverlay {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            z-index: 100; flex-direction: column; align-items: center; justify-content: center;
        }
        .game-frame { border: 4px solid #fff; box-shadow: 0 0 50px #fff; background: #000; position: relative; }
        .close-btn { margin-top: 20px; padding: 10px 30px; background: transparent; color: red; border: 2px solid red; font-family: inherit; cursor: pointer; font-size: 1.2em; }
        .close-btn:hover { background: red; color: white; }
    </style>
</head>
<body>

    <div id="loginGate" class="login-overlay">
        <div class="login-box">
            <h1>INSERT COIN</h1>
            <p>ENTER INITIALS</p>
            <input type="text" id="initialsInput" maxlength="3" placeholder="_ _ _" onkeypress="handleLoginKey(event)">
            <br>
            <button onclick="enterArcade()" style="background:#0f0; padding:10px 30px; border:none; cursor:pointer; font-family:inherit; font-weight:bold;">START</button>
        </div>
    </div>

    <div class="header">
        <div class="logo">üïπÔ∏è PIXEL-NET</div>
        <div id="playerDisplay">PLAYER: ???</div>
    </div>

    <div class="container">
        <div class="main-content">
            
            <div class="hero-section" id="heroBanner">
                <div class="hero-overlay"></div>
                <div class="hero-content">
                    <h2 style="margin:0; text-shadow: 0 0 10px #ff00ff;" id="heroTitle">üî• WEEKLY FEATURE</h2>
                    <p id="heroSubtitle" style="color:#fff; font-weight:bold;">LOADING DATA...</p>
                    <br>
                    <button id="heroButton" style="background:#ff00ff; border:none; padding:12px 30px; color:white; font-family:inherit; cursor:pointer; font-size:1.2em; font-weight:bold; box-shadow: 0 0 10px #ff00ff;">‚ñ∂ PLAY NOW</button>
                </div>
            </div>

            <div class="library-controls">
                <h3 style="margin:0;">// GAME LIBRARY</h3>
                <div class="search-wrapper">
                    <input type="text" id="gameSearch" placeholder="SEARCH TITLES..." onkeyup="filterGames()">
                </div>
            </div>

            <div class="game-grid" id="arcadeGrid">
                </div>
        </div>

        <div class="stats-panel">
            
            <div class="section-title">üèÜ THE IMMOVABLE DOGS</div>
            <div class="legend-row"><span class="rank">1</span><div class="legend-info"><span>ASH</span></div><div>99,400</div></div>
            <div class="legend-row"><span class="rank">2</span><div class="legend-info"><span>KAI</span></div><div>98,100</div></div>
            <div class="legend-row"><span class="rank">3</span><div class="legend-info"><span>BOB</span></div><div>85,000</div></div>
            <div class="legend-row"><span class="rank">4</span><div class="legend-info"><span>JON</span></div><div>72,000</div></div>
            <div class="legend-row"><span class="rank">5</span><div class="legend-info"><span>AMY</span></div><div>64,200</div></div>
            
            <br>
            <div class="section-title" style="color:#ff00ff; border-color:#ff00ff;">üöÄ BIG MOVERS</div>
            
            <div style="margin-bottom:15px; border-left:2px solid #ff00ff; padding-left:10px;">
                <div style="font-weight:bold;">ZED (Space Rocks)</div>
                <div style="color:#0f0; font-size:1.1em; text-shadow:0 0 5px #0f0;">+11,500</div>
            </div>

            <div style="margin-bottom:15px; border-left:2px solid #ff00ff; padding-left:10px;">
                <div style="font-weight:bold;">MAX (Millipede)</div>
                <div style="color:#0f0; font-size:1.1em; text-shadow:0 0 5px #0f0;">+8,200</div>
            </div>

            <div style="margin-bottom:15px; border-left:2px solid #ff00ff; padding-left:10px;">
                <div style="font-weight:bold;">LIA (Droid Arena)</div>
                <div style="color:#0f0; font-size:1.1em; text-shadow:0 0 5px #0f0;">+5,400</div>
            </div>
        </div>
    </div>

    <div id="gameOverlay">
        <div class="game-frame">
            <canvas id="gameCanvas" width="400" height="640" style="display:block; background:#000;"></canvas>
        </div>
        <button class="close-btn" onclick="closeGame()">[ EJECT CARTRIDGE ]</button>
        <div style="color:#666; margin-top:10px; font-size:12px;">ARROWS to Move ‚Ä¢ SPACE to Fire</div>
    </div>

    <script src="js/engine.js"></script>
    <script>
        window.onload = function() {
            const savedInitials = sessionStorage.getItem('playerInitials');
            if(savedInitials) {
                document.getElementById('initialsInput').value = savedInitials;
                enterArcade();
            }
            loadGames();
        };

        async function loadGames() {
            try {
                const response = await fetch('games.json');
                const games = await response.json();
                const grid = document.getElementById('arcadeGrid');
                
                grid.innerHTML = '';

                games.forEach(game => {
                    const cab = document.createElement('div');
                    cab.className = 'cabinet';
                    cab.setAttribute('data-name', game.title.toLowerCase());
                    cab.innerHTML = `
                        <div class="cabinet-screen">
                            <img src="${game.image}" class="cabinet-thumb" onerror="this.style.display='none'">
                        </div>
                        <div class="game-title">${game.title}</div>
                        <div class="game-desc">${game.description}</div>
                    `;
                    cab.onclick = () => launchGame(game.script);
                    grid.appendChild(cab);
                });

                // --- HERO LOGIC: FILL BACKGROUND ---
                if(games.length > 0) {
                    const hero = games[Math.floor(Math.random() * games.length)];
                    const banner = document.getElementById('heroBanner');
                    
                    banner.style.display = 'flex'; // Use flex to center content
                    // Set the image as the background of the box
                    banner.style.backgroundImage = `url('${hero.image}')`;
                    
                    document.getElementById('heroTitle').innerText = "üî• FEATURE: " + hero.title;
                    document.getElementById('heroSubtitle').innerText = hero.description;
                    document.getElementById('heroButton').onclick = () => launchGame(hero.script);
                }

            } catch (e) { console.error("System Error:", e); }
        }

        function launchGame(scriptPath) {
            let cleanPath = scriptPath;
            if(scriptPath.includes('games/')) cleanPath = scriptPath.replace('games/', '');
            if(!cleanPath.startsWith('js/')) cleanPath = 'js/' + cleanPath;

            const oldScript = document.getElementById('active-cartridge');
            if (oldScript) oldScript.remove();

            const script = document.createElement('script');
            script.src = cleanPath;
            script.id = 'active-cartridge';
            script.onerror = () => alert("ERROR: Could not find game file at " + cleanPath);

            document.body.appendChild(script);
            document.getElementById('gameOverlay').style.display = 'flex';
        }

        function closeGame() {
            document.getElementById('gameOverlay').style.display = 'none';
            window.location.reload(); 
        }

        function enterArcade() {
            const input = document.getElementById('initialsInput').value;
            if(input.length > 0) {
                sessionStorage.setItem('playerInitials', input.toUpperCase());
                document.getElementById('playerDisplay').innerText = "PLAYER: " + input.toUpperCase();
                document.getElementById('loginGate').style.opacity = '0';
                setTimeout(() => { document.getElementById('loginGate').style.display = 'none'; }, 500);
            } else { alert("ENTER INITIALS"); }
        }

        function handleLoginKey(event) { if (event.key === "Enter") enterArcade(); }

        function filterGames() {
            const term = document.getElementById("gameSearch").value.toLowerCase();
            const cabs = document.querySelectorAll(".cabinet");
            cabs.forEach(cab => {
                const name = cab.getAttribute("data-name");
                cab.style.display = name.includes(term) ? "" : "none";
            });
        }
    </script>
</body>
</html>
