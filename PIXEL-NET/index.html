<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PIXEL-NET | Online Arcade Network</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{--neon-pink:#ff006e;--neon-cyan:#00f5ff;--neon-purple:#b537f2;--neon-yellow:#ffea00;--neon-orange:#ff6b00;--deep-blue:#0a0e27;--dark-purple:#1a0933;--grid-color:rgba(0,245,255,.15)}
    body{font-family:'Rajdhani',sans-serif;background:linear-gradient(135deg,var(--deep-blue) 0%,var(--dark-purple) 100%);color:#fff;min-height:100vh;overflow-x:hidden;position:relative}
    body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background-image:linear-gradient(var(--grid-color) 1px,transparent 1px),linear-gradient(90deg,var(--grid-color) 1px,transparent 1px);background-size:50px 50px;animation:gridScroll 20s linear infinite;pointer-events:none;z-index:0}
    @keyframes gridScroll{0%{transform:perspective(500px) rotateX(60deg) translateY(0)}100%{transform:perspective(500px) rotateX(60deg) translateY(50px)}}
    body::after{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:repeating-linear-gradient(0deg,rgba(0,0,0,.15),rgba(0,0,0,.15) 1px,transparent 1px,transparent 2px);pointer-events:none;z-index:1000;opacity:.3}

    .container{max-width:1400px;margin:0 auto;padding:20px;position:relative;z-index:1}

    .header{text-align:center;padding:40px 20px 20px;position:relative}
    .logo{font-family:'Orbitron',sans-serif;font-size:4rem;font-weight:900;text-transform:uppercase;letter-spacing:8px;background:linear-gradient(45deg,var(--neon-cyan),var(--neon-pink),var(--neon-purple));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;filter:drop-shadow(0 0 20px rgba(0,245,255,.5));animation:logoGlow 3s ease-in-out infinite alternate;margin-bottom:10px}
    @keyframes logoGlow{0%{filter:drop-shadow(0 0 20px rgba(0,245,255,.5))}100%{filter:drop-shadow(0 0 35px rgba(255,0,110,.7))}}
    .tagline{font-size:1.2rem;color:var(--neon-cyan);text-transform:uppercase;letter-spacing:4px;font-weight:300;opacity:.8}

    .player-initials-display{font-family:'Orbitron',sans-serif;font-size:1.2rem;font-weight:700;color:var(--neon-cyan);text-shadow:0 0 15px var(--neon-cyan);letter-spacing:5px;margin:15px auto 0;display:none;cursor:pointer;transition:all .3s ease}
    .player-initials-display.active{display:block}
    .player-initials-display:hover{color:var(--neon-pink);text-shadow:0 0 20px var(--neon-pink);transform:scale(1.1)}

    .featured-section{margin:40px 0;background:linear-gradient(135deg,rgba(181,55,242,.1),rgba(255,0,110,.1));border:2px solid var(--neon-pink);border-radius:20px;padding:40px;box-shadow:0 0 30px rgba(255,0,110,.3),inset 0 0 30px rgba(181,55,242,.1);position:relative;overflow:hidden}
    .featured-section::before{content:'GAME OF THE WEEK';position:absolute;top:-1px;left:30px;background:var(--deep-blue);color:var(--neon-pink);padding:5px 20px;font-size:.85rem;font-weight:700;letter-spacing:2px;border:2px solid var(--neon-pink);border-top:none;border-radius:0 0 10px 10px}
    .featured-content{display:grid;grid-template-columns:350px 1fr;gap:40px;align-items:center}
    .featured-image{width:100%;aspect-ratio:1/1;border-radius:15px;border:3px solid var(--neon-cyan);box-shadow:0 10px 40px rgba(0,245,255,.4),0 0 0 1px rgba(255,255,255,.1);position:relative;overflow:hidden;animation:featuredPulse 4s ease-in-out infinite;background-size:cover;background-position:center;background-color:rgba(0,0,0,.2)}
    @keyframes featuredPulse{0%,100%{box-shadow:0 10px 40px rgba(0,245,255,.4)}50%{box-shadow:0 10px 60px rgba(255,0,110,.6)}}
    .featured-info h2{font-family:'Orbitron',sans-serif;font-size:3rem;font-weight:900;margin-bottom:15px;text-transform:uppercase;letter-spacing:3px;background:linear-gradient(90deg,#fff,var(--neon-cyan));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
    .featured-info p{font-size:1.1rem;margin-bottom:30px;color:rgba(255,255,255,.7);line-height:1.6}
    .btn-play{background:linear-gradient(135deg,var(--neon-cyan),var(--neon-pink));color:var(--deep-blue);border:none;padding:18px 50px;font-size:1.3rem;font-weight:700;font-family:'Orbitron',sans-serif;text-transform:uppercase;letter-spacing:3px;border-radius:50px;cursor:pointer;transition:all .3s ease;box-shadow:0 5px 25px rgba(0,245,255,.5);position:relative;overflow:hidden}
    .btn-play::before{content:'';position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:rgba(255,255,255,.3);transform:translate(-50%,-50%);transition:width .6s,height .6s}
    .btn-play:hover::before{width:300px;height:300px}
    .btn-play:hover{transform:translateY(-3px);box-shadow:0 8px 35px rgba(255,0,110,.7)}
    .btn-play:active{transform:translateY(-1px)}

    .section-header{display:flex;justify-content:space-between;align-items:center;margin:60px 0 30px;padding-bottom:15px;border-bottom:2px solid var(--neon-cyan);position:relative}
    .section-header::after{content:'';position:absolute;bottom:-2px;left:0;width:200px;height:2px;background:var(--neon-pink);animation:borderSlide 3s ease-in-out infinite}
    @keyframes borderSlide{0%,100%{left:0;width:200px}50%{left:calc(100% - 200px)}}
    .section-header h3{font-family:'Orbitron',sans-serif;font-size:2rem;font-weight:700;text-transform:uppercase;letter-spacing:3px;color:var(--neon-cyan)}
    .section-header p{font-size:1rem;color:rgba(255,255,255,.6);font-weight:300}

    .search-bar{background:rgba(0,0,0,.3);border:1px solid rgba(0,245,255,.3);border-radius:25px;padding:12px 25px;color:#fff;font-family:'Rajdhani',sans-serif;font-size:1rem;width:300px;transition:all .3s ease}
    .search-bar:focus{outline:none;border-color:var(--neon-cyan);box-shadow:0 0 20px rgba(0,245,255,.3)}
    .search-bar::placeholder{color:rgba(255,255,255,.4)}

    .games-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:25px;margin-bottom:60px}
    .game-card{background:rgba(0,0,0,.4);border:2px solid transparent;border-radius:15px;overflow:hidden;cursor:pointer;transition:all .4s cubic-bezier(.175,.885,.32,1.275);position:relative}
    .game-card::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,var(--neon-cyan),var(--neon-pink));opacity:0;transition:opacity .4s ease;z-index:-1;border-radius:15px}
    .game-card:hover{transform:translateY(-10px) scale(1.03);border-color:var(--neon-cyan);box-shadow:0 15px 40px rgba(0,245,255,.4),0 0 20px rgba(255,0,110,.3)}
    .game-card:hover::before{opacity:.1}
    .game-thumbnail{width:100%;aspect-ratio:1/1;background-size:cover;background-position:center;position:relative;overflow:hidden;background-color:rgba(255,255,255,.04)}
    .game-title{padding:20px;text-align:center;background:rgba(0,0,0,.6)}
    .game-title h4{font-family:'Orbitron',sans-serif;font-size:1.1rem;font-weight:700;text-transform:uppercase;letter-spacing:2px;margin-bottom:5px;background:linear-gradient(90deg,#fff,var(--neon-cyan));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}

    .leaderboards{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:30px;margin-bottom:60px}
    .leaderboard-card{background:rgba(0,0,0,.4);border:2px solid var(--neon-purple);border-radius:15px;padding:25px;box-shadow:0 5px 25px rgba(181,55,242,.2)}
    .leaderboard-card h4{font-family:'Orbitron',sans-serif;font-size:1.3rem;font-weight:700;text-transform:uppercase;letter-spacing:2px;margin-bottom:20px;color:var(--neon-purple);text-align:center}

    .leaderboard-item{display:flex;align-items:center;gap:15px;padding:12px;margin-bottom:10px;background:rgba(255,255,255,.03);border-radius:8px;border-left:3px solid transparent;transition:all .3s ease}
    .leaderboard-item:hover{background:rgba(255,255,255,.08);border-left-color:var(--neon-cyan);transform:translateX(5px)}
    .rank{font-family:'Orbitron',sans-serif;font-size:1.3rem;font-weight:900;min-width:35px;text-align:center}
    .rank.gold{color:var(--neon-yellow)}
    .rank.silver{color:#c0c0c0}
    .rank.bronze{color:var(--neon-orange)}

    .player-info{flex:1}
    .player-name{font-weight:600;font-size:1.1rem;margin-bottom:3px}
    .player-initials{font-family:'Orbitron',sans-serif;font-size:.85rem;color:var(--neon-cyan);font-weight:700}
    .score{font-family:'Orbitron',sans-serif;font-size:1rem;font-weight:700;color:rgba(255,255,255,.6);white-space:nowrap}

    .footer{text-align:center;padding:40px 20px;border-top:1px solid rgba(0,245,255,.2);margin-top:60px}
    .footer p{color:rgba(255,255,255,.4);font-size:.9rem;margin-bottom:10px}
    .footer-links{display:flex;justify-content:center;gap:20px;margin-top:15px;flex-wrap:wrap}
    .footer-links a{color:var(--neon-cyan);text-decoration:none;font-weight:600;transition:all .3s ease;position:relative}
    .footer-links a::after{content:'';position:absolute;bottom:-3px;left:0;width:0;height:2px;background:var(--neon-pink);transition:width .3s ease}
    .footer-links a:hover::after{width:100%}

    .modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.9);backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:center;z-index:2000;animation:fadeIn .3s ease}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    .modal{background:linear-gradient(135deg,rgba(10,14,39,.95),rgba(26,9,51,.95));border:3px solid var(--neon-cyan);border-radius:20px;padding:50px;max-width:500px;width:90%;box-shadow:0 20px 60px rgba(0,245,255,.3),inset 0 0 40px rgba(181,55,242,.1);position:relative;animation:modalSlideIn .5s cubic-bezier(.175,.885,.32,1.275)}
    @keyframes modalSlideIn{from{opacity:0;transform:scale(.8) translateY(-50px)}to{opacity:1;transform:scale(1) translateY(0)}}
    .modal-close{position:absolute;top:15px;right:15px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.2);color:#fff;width:35px;height:35px;border-radius:50%;font-size:1.2rem;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center}
    .modal-close:hover{background:var(--neon-pink);border-color:var(--neon-pink);transform:rotate(90deg)}
    .modal h2{font-family:'Orbitron',sans-serif;font-size:2rem;font-weight:900;text-transform:uppercase;letter-spacing:3px;margin-bottom:30px;text-align:center;background:linear-gradient(90deg,var(--neon-cyan),var(--neon-pink));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
    .initials-input-container{position:relative;margin-bottom:30px}
    .initials-input{width:100%;background:rgba(0,0,0,.5);border:2px solid rgba(0,245,255,.3);border-radius:10px;padding:15px;color:#fff;font-family:'Orbitron',sans-serif;font-size:1.5rem;text-align:center;text-transform:uppercase;letter-spacing:15px;transition:all .3s ease}
    .initials-input:focus{outline:none;border-color:var(--neon-cyan);box-shadow:0 0 20px rgba(0,245,255,.4)}
    .btn-save{width:100%;background:linear-gradient(135deg,var(--neon-cyan),var(--neon-purple));color:#fff;border:none;padding:18px;font-size:1.2rem;font-weight:700;font-family:'Orbitron',sans-serif;text-transform:uppercase;letter-spacing:3px;border-radius:10px;cursor:pointer;transition:all .3s ease;box-shadow:0 5px 25px rgba(0,245,255,.4)}
    .btn-save:hover{transform:translateY(-2px);box-shadow:0 8px 35px rgba(181,55,242,.6)}
    .btn-save:active{transform:translateY(0)}
    .hint-text{text-align:center;color:rgba(255,255,255,.5);font-size:.9rem;margin-top:15px;font-style:italic}

    @media (max-width:968px){
      .featured-content{grid-template-columns:1fr;text-align:center}
      .featured-image{max-width:350px;margin:0 auto}
      .logo{font-size:2.5rem;letter-spacing:4px}
      .games-grid{grid-template-columns:repeat(auto-fill,minmax(180px,1fr))}
      .leaderboards{grid-template-columns:1fr}
      .section-header{flex-direction:column;gap:20px;align-items:flex-start}
      .search-bar{width:100%}
    }
    @media (max-width:640px){
      .modal{padding:30px 20px}
      .initials-input{font-size:1.2rem;letter-spacing:10px}
    }
  </style>
</head>
<body>
  <div class="modal-overlay" id="initialModal">
    <div class="modal">
      <button class="modal-close" onclick="closeModal()">√ó</button>
      <h2>Enter Initials</h2>
      <div class="initials-input-container">
        <input type="text" class="initials-input" id="initialsInput" maxlength="3" placeholder="___" autocomplete="off" />
      </div>
      <button class="btn-save" onclick="saveInitials()">SAVE</button>
      <p class="hint-text">Press Enter to save</p>
    </div>
  </div>

  <div class="container">
    <header class="header">
      <h1 class="logo">PIXEL-NET</h1>
      <p class="tagline">Online Arcade Network</p>
      <div class="player-initials-display" id="playerInitials" onclick="showModal()">---</div>
    </header>

    <section class="featured-section">
      <div class="featured-content">
        <div class="featured-image" id="featuredImage"></div>
        <div class="featured-info">
          <h2 id="featuredTitle">Loading‚Ä¶</h2>
          <p id="featuredDescription">Loading‚Ä¶</p>
          <button class="btn-play" id="btnPlayFeatured">Play Featured</button>
        </div>
      </div>
    </section>

    <div class="section-header">
      <div>
        <h3>Arcade Floor</h3>
        <p>Pick a cabinet. Click to play.</p>
      </div>
      <input type="text" class="search-bar" id="gameSearch" placeholder="Search games..." />
    </div>

    <div class="games-grid" id="gamesGrid"></div>

    <div class="section-header">
      <div>
        <h3>Leaderboards</h3>
        <p>Top Dogs = longest time held at #1. Recent Champions = newest #1 spot claims.</p>
      </div>
    </div>

    <div class="leaderboards">
      <div class="leaderboard-card">
        <h4>üèÜ All-Time Top Dogs</h4>
        <div class="leaderboard-item"><div class="rank gold">#1</div><div class="player-info"><div class="player-name">vector duel</div><div class="player-initials">TJW</div></div><div class="score" data-minutes="11352">7.9 days</div></div>
        <div class="leaderboard-item"><div class="rank silver">#2</div><div class="player-info"><div class="player-name">Cyber Python</div><div class="player-initials">GTS</div></div><div class="score" data-minutes="2748">1.9 days</div></div>
        <div class="leaderboard-item"><div class="rank bronze">#3</div><div class="player-info"><div class="player-name">Neon Chase</div><div class="player-initials">JRF</div></div><div class="score" data-minutes="240">4.0 hrs</div></div>
      </div>

      <div class="leaderboard-card">
        <h4>‚ö° Recent Champions</h4>
        <div class="leaderboard-item"><div class="rank">ü•á</div><div class="player-info"><div class="player-name">Millipede Chaos</div><div class="player-initials">TJW</div></div><div class="score">2 min ago</div></div>
        <div class="leaderboard-item"><div class="rank">ü•à</div><div class="player-info"><div class="player-name">Logic Bomb</div><div class="player-initials">GTS</div></div><div class="score">15 min ago</div></div>
        <div class="leaderboard-item"><div class="rank">ü•â</div><div class="player-info"><div class="player-name">Neon Arena Assault</div><div class="player-initials">JRF</div></div><div class="score">1 hr ago</div></div>
        <div class="leaderboard-item"><div class="rank">4</div><div class="player-info"><div class="player-name">Robo Arena</div><div class="player-initials">TJW</div></div><div class="score">3 hrs ago</div></div>
        <div class="leaderboard-item"><div class="rank">5</div><div class="player-info"><div class="player-name">Caked Up Cats</div><div class="player-initials">KLM</div></div><div class="score">5 hrs ago</div></div>
        <div class="leaderboard-item"><div class="rank">6</div><div class="player-info"><div class="player-name">Astrotype</div><div class="player-initials">JRF</div></div><div class="score">1 day ago</div></div>
        <div class="leaderboard-item"><div class="rank">7</div><div class="player-info"><div class="player-name">Neon Run</div><div class="player-initials">ABC</div></div><div class="score">2 days ago</div></div>
      </div>
    </div>

    <footer class="footer">
      <p>Built by Tyler Waggoner ‚Ä¢ Powered by AI</p>
      <div class="footer-links">
        <a href="#" onclick="window.scrollTo({top:0,behavior:'smooth'});return false;">PIXEL-NET</a>
        <a href="https://github.com/28twagg-ops" target="_blank" rel="noopener">GitHub</a>
        <a href="#" onclick="localStorage.removeItem('px_player_initials'); sessionStorage.removeItem('playerInitials'); location.reload(); return false;">Reset Initials</a>
      </div>
    </footer>
  </div>

  <script>
    // ===== Initials (aligned with engine.js keys) =====
    const KEY_LOCAL = 'px_player_initials';
    const KEY_SESSION = 'playerInitials';

    const modal = document.getElementById('initialModal');
    const input = document.getElementById('initialsInput');
    const playerInitials = document.getElementById('playerInitials');

    input.addEventListener('input', (e) => {
      const v = (e.target.value || '').toUpperCase().replace(/[^A-Z0-9]/g,'').slice(0,3);
      e.target.value = v;
    });

    input.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') saveInitials();
    });

    function saveInitials(){
      const initials = (input.value || '').toUpperCase().replace(/[^A-Z0-9]/g,'').slice(0,3);
      if(initials.length === 3){
        localStorage.setItem(KEY_LOCAL, initials);
        sessionStorage.setItem(KEY_SESSION, initials);
        updatePlayerInitials(initials);
        closeModal();
      }else{
        input.style.animation='none';
        setTimeout(()=>{ input.style.animation='shake .5s'; },10);
      }
    }

    function updatePlayerInitials(initials){
      playerInitials.textContent = initials;
      playerInitials.classList.add('active');
    }

    function showModal(){
      modal.style.display='flex';
      modal.style.animation='fadeIn .3s ease';
      setTimeout(()=>{ try{ input.focus(); }catch(_){} }, 100);
    }

    function closeModal(){
      modal.style.animation='fadeOut .3s ease';
      setTimeout(()=>{ modal.style.display='none'; }, 300);
    }

    // ===== Games (from existing games.json) =====
    const gamesGrid = document.getElementById('gamesGrid');
    const searchInput = document.getElementById('gameSearch');
    const featuredImage = document.getElementById('featuredImage');
    const featuredTitle = document.getElementById('featuredTitle');
    const featuredDescription = document.getElementById('featuredDescription');
    const btnPlayFeatured = document.getElementById('btnPlayFeatured');

    let allGames = [];
    let featuredGame = null;

    function normalizeGame(g){
      const id = g.id || g.slug || g.gameSlug || '';
      const title = g.title || g.name || id || 'Untitled';
      const desc = g.desc || g.description || '';
      const thumb = g.thumb || g.image || g.thumbnail || '';
      return { id, title, desc, thumb };
    }

    function playGame(id){
      if(!id) return;
      // Wrappers live at /PIXEL-NET/games/<id>/
      window.location.href = `games/${id}/`;
    }

    function renderGames(list){
      gamesGrid.innerHTML = '';
      list.forEach(game => {
        const card = document.createElement('div');
        card.className = 'game-card';
        const thumbUrl = game.thumb ? game.thumb : 'assets/placeholder.png';
        card.innerHTML = `
          <div class="game-thumbnail" style="background-image:url('${thumbUrl}')"></div>
          <div class="game-title"><h4>${escapeHtml(game.title)}</h4></div>
        `;
        card.addEventListener('click', () => playGame(game.id));
        gamesGrid.appendChild(card);
      });
    }

    function setFeatured(game){
      featuredGame = game;
      const thumbUrl = game?.thumb ? game.thumb : '';
      featuredImage.style.backgroundImage = thumbUrl ? `url('${thumbUrl}')` : 'none';
      featuredTitle.textContent = game?.title || 'Featured Game';
      featuredDescription.textContent = game?.desc || 'Pick a cabinet below to play.';
      btnPlayFeatured.onclick = () => playGame(game?.id);
    }

    function escapeHtml(s){
      return String(s ?? '').replace(/[&<>"]+/g, (ch) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[ch] || ch));
    }

    async function boot(){
      // initials
      const saved = (sessionStorage.getItem(KEY_SESSION) || localStorage.getItem(KEY_LOCAL) || '').toUpperCase();
      if(saved && saved.length === 3){
        updatePlayerInitials(saved);
        modal.style.display = 'none';
      }else{
        modal.style.display = 'flex';
        setTimeout(()=>{ try{ input.focus(); }catch(_){} }, 100);
      }

      // games
      try{
        const res = await fetch('games.json', { cache: 'no-store' });
        const data = await res.json();
        const raw = Array.isArray(data) ? data : (Array.isArray(data.games) ? data.games : []);
        allGames = raw.map(normalizeGame).filter(g => g.id);
      }catch(err){
        console.error('Could not load games.json', err);
        allGames = [];
      }

      // Choose featured: prefer millipede-chaos if present, else first.
      const preferred = allGames.find(g => g.id === 'millipede-chaos');
      setFeatured(preferred || allGames[0] || { id:'', title:'No games found', desc:'games.json failed to load.', thumb:'' });

      renderGames(allGames);

      // search filter
      searchInput.addEventListener('input', () => {
        const q = (searchInput.value || '').toLowerCase().trim();
        if(!q){ renderGames(allGames); return; }
        const filtered = allGames.filter(g => (g.title||'').toLowerCase().includes(q) || (g.id||'').toLowerCase().includes(q));
        renderGames(filtered);
      });
    }

    // Animations injected
    const style = document.createElement('style');
    style.textContent = `
      @keyframes shake{0%,100%{transform:translateX(0)}10%,30%,50%,70%,90%{transform:translateX(-10px)}20%,40%,60%,80%{transform:translateX(10px)}}
      @keyframes fadeOut{from{opacity:1}to{opacity:0}}
    `;
    document.head.appendChild(style);

    window.addEventListener('load', boot);
  </script>
</body>
</html>
