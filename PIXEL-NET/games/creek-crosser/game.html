<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Creek Crosser</title>
    <style>
        :root {
            --bg-color: #2c3e50;
            --ui-color: #ecf0f1;
            --accent-color: #f1c40f;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--ui-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
            touch-action: none;
        }

        #game-container {
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border-radius: 8px;
            overflow: hidden;
            background: #000;
            display: flex;
            flex-direction: column; 
        }

        canvas {
            display: block;
            background-color: #000;
        }

        #ui-layer {
            position: relative;
            width: 100%;
            background: #34495e; 
            padding: 10px 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
            border-top: 4px solid #2c3e50;
        }

        .hud-group {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .hud-text {
            font-size: 18px;
            font-weight: bold;
            text-shadow: 1px 1px 0 #000;
            color: var(--ui-color);
        }

        #game-over-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            pointer-events: auto;
            z-index: 10;
        }

        h1 {
            font-size: 40px;
            margin: 0 0 20px 0;
            color: var(--accent-color);
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 3px 3px 0 #e67e22;
        }

        button {
            background: var(--accent-color);
            border: none;
            padding: 15px 40px;
            font-size: 20px;
            font-weight: bold;
            color: #2c3e50;
            cursor: pointer;
            border-radius: 50px;
            transition: transform 0.1s, background 0.2s;
            box-shadow: 0 5px 15px rgba(241, 196, 15, 0.4);
            text-transform: uppercase;
        }

        button:hover {
            transform: scale(1.05);
            background: #f39c12;
        }

        button:active {
            transform: scale(0.95);
        }

        #mobile-controls {
            display: none;
            position: absolute;
            bottom: 80px; 
            left: 50%;
            transform: translateX(-50%);
            width: 160px;
            height: 160px;
            pointer-events: auto;
            z-index: 5;
            opacity: 0.6;
        }

        .d-btn {
            position: absolute;
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            user-select: none;
        }

        .d-btn:active { background: rgba(255, 255, 255, 0.5); }
        .d-up { top: 0; left: 55px; }
        .d-down { bottom: 0; left: 55px; }
        .d-left { top: 55px; left: 0; }
        .d-right { top: 55px; right: 0; }

        @media (hover: none) and (pointer: coarse) {
            #mobile-controls { display: block; }
        }

        /* Updated Sound Button Style */
        #mute-btn {
            background: transparent;
            color: var(--ui-color);
            border: 2px solid rgba(236, 240, 241, 0.5);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: none;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.2s;
            margin: 0 10px;
        }

        #mute-btn:hover {
            background: var(--ui-color);
            color: var(--bg-color);
            transform: scale(1.05);
        }
    </style>
</head>
<body>

    <div id="game-container">
        <canvas id="gameCanvas"></canvas>

        <div id="ui-layer">
            <div class="hud-group">
                <span class="hud-text" id="score-display">SCORE: 0</span>
                <span class="hud-text" id="level-display">LEVEL: 1</span>
            </div>

            <button id="mute-btn">SOUND: ON</button>

            <div class="hud-group">
                <span class="hud-text" id="time-display">TIME: 60</span>
                <span class="hud-text" id="lives-display">LIVES: 3</span>
            </div>
        </div>

        <div id="mobile-controls">
            <div class="d-btn d-up" id="btn-up">▲</div>
            <div class="d-btn d-left" id="btn-left">◀</div>
            <div class="d-btn d-right" id="btn-right">▶</div>
            <div class="d-btn d-down" id="btn-down">▼</div>
        </div>

        <div id="game-over-screen">
            <h1 id="end-title">GAME OVER</h1>
            <p style="font-size: 24px; margin-bottom: 30px;">Final Score: <span id="final-score">0</span></p>
            <button onclick="resetGame()">Try Again</button>
        </div>
    </div>

<script>
/**
 * CREEK CROSSER
 * Version 3.3: UI Update & Sound Toggle Move
 */

// --- Constants & Config ---
const GRID_SIZE = 40;
const COLS = 13;
const ROWS = 13;
const CANVAS_WIDTH = COLS * GRID_SIZE;
const CANVAS_HEIGHT = ROWS * GRID_SIZE;

// --- Visual Themes ---
const THEMES = [
    { water: "#3498db", waterDark: "#2980b9", grass: "#27ae60", road: "#34495e", goal: "#2ecc71", name: "Summer Creek" },
    { water: "#e67e22", waterDark: "#d35400", grass: "#f1c40f", road: "#5d4037", goal: "#d35400", name: "Sunset Valley" },
    { water: "#7f8c8d", waterDark: "#95a5a6", grass: "#bdc3c7", road: "#2c3e50", goal: "#7f8c8d", name: "Iron Works" },
    { water: "#81ecec", waterDark: "#00cec9", grass: "#a29bfe", road: "#74b9ff", goal: "#6c5ce7", name: "Cloud City" },
    { water: "#e74c3c", waterDark: "#c0392b", grass: "#2c3e50", road: "#2c3e50", goal: "#c0392b", name: "Lava Land" }
];

// --- Audio System ---
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
let isMuted = false;

const SoundManager = {
    playTone: (freq, type, duration, vol = 0.1) => {
        if (isMuted || audioCtx.state === 'suspended') return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        gain.gain.setValueAtTime(vol, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
    },
    jump: () => SoundManager.playTone(300, 'square', 0.1),
    goal: () => {
        SoundManager.playTone(600, 'sine', 0.1, 0.2);
        setTimeout(() => SoundManager.playTone(900, 'sine', 0.2, 0.2), 100);
    },
    die: () => {
        if (isMuted || audioCtx.state === 'suspended') return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(200, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.3);
        gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.3);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.3);
    },
    win: () => {
        [440, 554, 659, 880].forEach((f, i) => setTimeout(() => SoundManager.playTone(f, 'square', 0.2, 0.15), i * 150));
    },
    timeWarning: () => SoundManager.playTone(150, 'square', 0.1, 0.1)
};

// Resume audio context on interaction
document.body.addEventListener('click', () => { if(audioCtx.state === 'suspended') audioCtx.resume(); }, {once:true});
document.body.addEventListener('touchstart', () => { if(audioCtx.state === 'suspended') audioCtx.resume(); }, {once:true});
document.getElementById('mute-btn').addEventListener('click', (e) => {
    isMuted = !isMuted;
    e.target.innerText = isMuted ? "SOUND: OFF" : "SOUND: ON";
    e.target.blur(); // Remove focus
});


// --- Game State ---
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let lastTime = 0;

let gameState = {
    score: 0,
    lives: 3,
    level: 1,
    time: 60,
    isGameOver: false,
    isTransitioning: false, 
    transitionX: -500,     
    goalsReached: 0,
    goalSlots: [false, false, false, false, false],
    victory: false,
    frameCount: 0,
    particles: [],
    roamingPlatforms: [] // For Level 4+
};

... (TRUNCATED FOR BREVITY: full game code inserted here in actual file)
</script>
</body>
</html>
